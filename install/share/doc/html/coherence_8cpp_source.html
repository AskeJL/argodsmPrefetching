<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ArgoDSM - Software Distributed Shared Memory: /home/projectcs-2022/argodsmBuffer/argodsmPrefetching/src/backend/mpi/coherence.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ArgoDSM - Software Distributed Shared Memory
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3f615ade772d23cefe5e20dcb18424a2.html">backend</a></li><li class="navelem"><a class="el" href="dir_cd56f9bb444c4dcc895557544c79ce2a.html">mpi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">coherence.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="coherence_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;shared_mutex&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="backend_8hpp.html">backend/backend.hpp</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="swdsm_8h.html">backend/mpi/swdsm.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="virtual__memory_8hpp.html">virtual_memory/virtual_memory.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceargo.html">argo</a> {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span>backend {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="backend_8hpp_a0fb29a8253f0d9aefc999d93414b1758.html#a0fb29a8253f0d9aefc999d93414b1758">   17</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="backend_8hpp_a0fb29a8253f0d9aefc999d93414b1758.html#a0fb29a8253f0d9aefc999d93414b1758">_selective_acquire</a>(<span class="keywordtype">void</span> *addr, std::size_t <a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a>) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// Skip selective acquire if the size of the region is 0</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a> == 0) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">const</span> std::size_t <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a> = <a class="code" href="swdsm_8h_a07958ee0efecb1f7c4fa09ecff2dd810.html#a07958ee0efecb1f7c4fa09ecff2dd810">page_size</a>*<a class="code" href="swdsm_8h_aa62717a1fae2c57f94f2a9b8ae08ec49.html#aa62717a1fae2c57f94f2a9b8ae08ec49">CACHELINE</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">const</span> std::size_t start_address = <span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(argo::virtual_memory::start_address());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">const</span> std::size_t page_misalignment = <span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(addr)%<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    std::size_t argo_address =</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        ((<span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(addr)-start_address)/<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>)*<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceargo_ace770d0e23081b9b47668b33d4e75355.html#ace770d0e23081b9b47668b33d4e75355">node_id_t</a> <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a> = <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">argo::backend::node_id</a>();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">const</span> std::size_t node_id_bit = <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(1) &lt;&lt; <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// Lock relevant mutexes. Start statistics timekeeping</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">double</span> t1 = MPI_Wtime();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    std::shared_lock lock(<a class="code" href="swdsm_8cpp_aae35b8e60baeba2eb90d7e7a83043346.html#aae35b8e60baeba2eb90d7e7a83043346">sync_lock</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Iterate over all pages to selectively invalidate</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">for</span>(std::size_t page_address = argo_address;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            page_address &lt; argo_address + page_misalignment + <a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            page_address += <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceargo_ace770d0e23081b9b47668b33d4e75355.html#ace770d0e23081b9b47668b33d4e75355">node_id_t</a> homenode_id = <a class="code" href="swdsm_8cpp_ac2a76a52d43c19cf7d5ed770e14c4409.html#ac2a76a52d43c19cf7d5ed770e14c4409">peek_homenode</a>(page_address);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="comment">// This page should be skipped in the following cases</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">// 1. The page is node local so no acquire is necessary</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">// 2. The page has not yet been first-touched and trying</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">// to perform an acquire would first-touch the page</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span>( homenode_id == <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a> ||</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            homenode_id == <a class="code" href="namespaceargo_1_1data__distribution_a88ff6bbc68aad43df4ae1cb78f6368bd.html#a88ff6bbc68aad43df4ae1cb78f6368bd">argo::data_distribution::invalid_node_id</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">const</span> std::size_t cache_index = <a class="code" href="swdsm_8cpp_a59e4c59c2940cc3727debeeff4af1889.html#a59e4c59c2940cc3727debeeff4af1889">getCacheIndex</a>(page_address);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">const</span> std::size_t classification_index = <a class="code" href="swdsm_8cpp_aff9ea7ba7f37206d933c8dc8004dbc7b.html#aff9ea7ba7f37206d933c8dc8004dbc7b">get_classification_index</a>(page_address);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="swdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f.html#ae246927bf47d0461b35f0c4c111c728f">cache_locks</a>[cache_index].lock();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">// Poke the MPI system to force progress</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordtype">int</span> flag;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        MPI_Iprobe(MPI_ANY_SOURCE, MPI_ANY_TAG, <a class="code" href="swdsm_8cpp_ae2fb6919b62fcd672847de7754e84e98.html#ae2fb6919b62fcd672847de7754e84e98">argo_comm</a>, &amp;flag, MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        std::size_t win_index = <a class="code" href="swdsm_8cpp_a7d0d0386804df222465aaa199aab92da.html#a7d0d0386804df222465aaa199aab92da">get_sharer_win_index</a>(classification_index);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">// Optimization to keep pages in cache if they do not</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">// need to be invalidated.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="swdsm_8cpp_a5be7d91057d2e1e8933a8c92dcbd19ce.html#a5be7d91057d2e1e8933a8c92dcbd19ce">mpi_lock_sharer</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>].<a class="code" href="classmpi__lock_a67301b26c3bb28c746e164c9f531d21d.html#a67301b26c3bb28c746e164c9f531d21d">lock</a>(MPI_LOCK_SHARED, <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>, <a class="code" href="swdsm_8cpp_a78647f412cdb8035c499e3ba7815fdfe.html#a78647f412cdb8035c499e3ba7815fdfe">sharer_windows</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>]);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">// node is single writer</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                (<a class="code" href="swdsm_8cpp_a8c349e3402bea4a398112f54fcfb7a0a.html#a8c349e3402bea4a398112f54fcfb7a0a">globalSharers</a>[classification_index+1] == node_id_bit)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                ||</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="comment">// No writer and assert that the node is a sharer</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                ((<a class="code" href="swdsm_8cpp_a8c349e3402bea4a398112f54fcfb7a0a.html#a8c349e3402bea4a398112f54fcfb7a0a">globalSharers</a>[classification_index+1] == 0) &amp;&amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                 ((<a class="code" href="swdsm_8cpp_a8c349e3402bea4a398112f54fcfb7a0a.html#a8c349e3402bea4a398112f54fcfb7a0a">globalSharers</a>[classification_index] &amp; node_id_bit) == node_id_bit))</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          ) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="swdsm_8cpp_a5be7d91057d2e1e8933a8c92dcbd19ce.html#a5be7d91057d2e1e8933a8c92dcbd19ce">mpi_lock_sharer</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>].<a class="code" href="classmpi__lock_a38cb3649cba54a2818810c444a8b475a.html#a38cb3649cba54a2818810c444a8b475a">unlock</a>(<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>, <a class="code" href="swdsm_8cpp_a78647f412cdb8035c499e3ba7815fdfe.html#a78647f412cdb8035c499e3ba7815fdfe">sharer_windows</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>]);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="swdsm_8cpp_ac87b1e995ffe192a9cdd46c1686686c0.html#ac87b1e995ffe192a9cdd46c1686686c0">touchedcache</a>[cache_index] = 1;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="comment">// nothing - we keep the pages, SD is done in flushWB</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">// multiple writer or SO, invalidate the page</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="swdsm_8cpp_a5be7d91057d2e1e8933a8c92dcbd19ce.html#a5be7d91057d2e1e8933a8c92dcbd19ce">mpi_lock_sharer</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>].<a class="code" href="classmpi__lock_a38cb3649cba54a2818810c444a8b475a.html#a38cb3649cba54a2818810c444a8b475a">unlock</a>(<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>, <a class="code" href="swdsm_8cpp_a78647f412cdb8035c499e3ba7815fdfe.html#a78647f412cdb8035c499e3ba7815fdfe">sharer_windows</a>[win_index][<a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a>]);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <a class="code" href="swdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9.html#a47bd1cf6b67fdc3919a12b2c622b0ae9">cacheControl</a>[cache_index].<a class="code" href="structmyControlData_a6db6cf5782f7ca2f19dd4e6f6d0b9e43.html#a6db6cf5782f7ca2f19dd4e6f6d0b9e43">dirty</a> = <a class="code" href="swdsm_8h_a2315af8277ada7b9534af936c69891ce.html#a2315af8277ada7b9534af936c69891ce">CLEAN</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="swdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9.html#a47bd1cf6b67fdc3919a12b2c622b0ae9">cacheControl</a>[cache_index].<a class="code" href="structmyControlData_a74aa16e0dfe9276eb5f598545271dcf1.html#a74aa16e0dfe9276eb5f598545271dcf1">state</a> = <a class="code" href="swdsm_8h_a3aad0c262829e881d9cfa79db6223f05.html#a3aad0c262829e881d9cfa79db6223f05">INVALID</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="swdsm_8cpp_ac87b1e995ffe192a9cdd46c1686686c0.html#ac87b1e995ffe192a9cdd46c1686686c0">touchedcache</a>[cache_index] = 0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            mprotect(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(start_address) + page_address, <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>, PROT_NONE);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="swdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f.html#ae246927bf47d0461b35f0c4c111c728f">cache_locks</a>[cache_index].unlock();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">double</span> t2 = MPI_Wtime();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Poke the MPI system to force progress</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">int</span> flag;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    MPI_Iprobe(MPI_ANY_SOURCE, MPI_ANY_TAG, <a class="code" href="swdsm_8cpp_ae2fb6919b62fcd672847de7754e84e98.html#ae2fb6919b62fcd672847de7754e84e98">argo_comm</a>, &amp;flag, MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::lock_guard&lt;std::mutex&gt; ssi_time_lock(<a class="code" href="swdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e.html#a5a165c3e2fa2511a6beea1dcb9b7462e">stats</a>.<a class="code" href="structargo__statistics__struct_ade3cc629c5e69fd468d589795f08db6a.html#ade3cc629c5e69fd468d589795f08db6a">ssi_time_mutex</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="swdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e.html#a5a165c3e2fa2511a6beea1dcb9b7462e">stats</a>.<a class="code" href="structargo__statistics__struct_a23ea11937749a7322ce532a5cf0cce4d.html#a23ea11937749a7322ce532a5cf0cce4d">ssi_time</a> += t2-t1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="backend_8hpp_ac3350bde3c8baf64753e515336fad3be.html#ac3350bde3c8baf64753e515336fad3be">   92</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="backend_8hpp_ac3350bde3c8baf64753e515336fad3be.html#ac3350bde3c8baf64753e515336fad3be">_selective_release</a>(<span class="keywordtype">void</span> *addr, std::size_t <a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Skip selective release if the size of the region is 0</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a> == 0) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">const</span> std::size_t <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a> = <a class="code" href="swdsm_8h_a07958ee0efecb1f7c4fa09ecff2dd810.html#a07958ee0efecb1f7c4fa09ecff2dd810">page_size</a>*<a class="code" href="swdsm_8h_aa62717a1fae2c57f94f2a9b8ae08ec49.html#aa62717a1fae2c57f94f2a9b8ae08ec49">CACHELINE</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> std::size_t start_address = <span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(argo::virtual_memory::start_address());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">const</span> std::size_t page_misalignment = <span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(addr)%<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::size_t argo_address =</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        ((<span class="keyword">reinterpret_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(addr)-start_address)/<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>)*<a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceargo_ace770d0e23081b9b47668b33d4e75355.html#ace770d0e23081b9b47668b33d4e75355">node_id_t</a> <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a> = <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">argo::backend::node_id</a>();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Lock relevant mutexes. Start statistics timekeeping</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">double</span> t1 = MPI_Wtime();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    std::shared_lock lock(<a class="code" href="swdsm_8cpp_aae35b8e60baeba2eb90d7e7a83043346.html#aae35b8e60baeba2eb90d7e7a83043346">sync_lock</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Iterate over all pages to selectively downgrade</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span>(std::size_t page_address = argo_address;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            page_address &lt; argo_address + page_misalignment + <a class="code" href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            page_address += <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceargo_ace770d0e23081b9b47668b33d4e75355.html#ace770d0e23081b9b47668b33d4e75355">node_id_t</a> homenode_id = <a class="code" href="swdsm_8cpp_ac2a76a52d43c19cf7d5ed770e14c4409.html#ac2a76a52d43c19cf7d5ed770e14c4409">peek_homenode</a>(page_address);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// selective_release should be skipped in the following cases</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// 1. The page is node local so no release is necessary</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// 2. The page has not yet been first-touched and trying</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// to perform a release would first-touch the page</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span>( homenode_id == <a class="code" href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">node_id</a> ||</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            homenode_id == <a class="code" href="namespaceargo_1_1data__distribution_a88ff6bbc68aad43df4ae1cb78f6368bd.html#a88ff6bbc68aad43df4ae1cb78f6368bd">argo::data_distribution::invalid_node_id</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">const</span> std::size_t cache_index = <a class="code" href="swdsm_8cpp_a59e4c59c2940cc3727debeeff4af1889.html#a59e4c59c2940cc3727debeeff4af1889">getCacheIndex</a>(page_address);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="swdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f.html#ae246927bf47d0461b35f0c4c111c728f">cache_locks</a>[cache_index].lock();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// If the page is dirty, downgrade it</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="swdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9.html#a47bd1cf6b67fdc3919a12b2c622b0ae9">cacheControl</a>[cache_index].dirty == <a class="code" href="swdsm_8h_a60932aba9f294e6d63e2bcaa085d4b8d.html#a60932aba9f294e6d63e2bcaa085d4b8d">DIRTY</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            mprotect(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(start_address) + page_address, <a class="code" href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a>, PROT_READ);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt;<a class="code" href="swdsm_8h_aa62717a1fae2c57f94f2a9b8ae08ec49.html#aa62717a1fae2c57f94f2a9b8ae08ec49">CACHELINE</a>; i++) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <a class="code" href="swdsm_8cpp_a3b6a6b2b244edb9faa79814ce8e5e9f5.html#a3b6a6b2b244edb9faa79814ce8e5e9f5">storepageDIFF</a>(cache_index+i, page_address+<a class="code" href="swdsm_8h_a07958ee0efecb1f7c4fa09ecff2dd810.html#a07958ee0efecb1f7c4fa09ecff2dd810">page_size</a>*i);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <a class="code" href="swdsm_8cpp_aa2b2930f8400209562515c100a4ed0da.html#aa2b2930f8400209562515c100a4ed0da">argo_write_buffer</a>-&gt;erase(cache_index);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="swdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9.html#a47bd1cf6b67fdc3919a12b2c622b0ae9">cacheControl</a>[cache_index].<a class="code" href="structmyControlData_a6db6cf5782f7ca2f19dd4e6f6d0b9e43.html#a6db6cf5782f7ca2f19dd4e6f6d0b9e43">dirty</a> = <a class="code" href="swdsm_8h_a2315af8277ada7b9534af936c69891ce.html#a2315af8277ada7b9534af936c69891ce">CLEAN</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="swdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f.html#ae246927bf47d0461b35f0c4c111c728f">cache_locks</a>[cache_index].unlock();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">double</span> t2 = MPI_Wtime();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Poke the MPI system to force progress</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> flag;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    MPI_Iprobe(MPI_ANY_SOURCE, MPI_ANY_TAG, <a class="code" href="swdsm_8cpp_ae2fb6919b62fcd672847de7754e84e98.html#ae2fb6919b62fcd672847de7754e84e98">argo_comm</a>, &amp;flag, MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    std::lock_guard&lt;std::mutex&gt; ssd_time_lock(<a class="code" href="swdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e.html#a5a165c3e2fa2511a6beea1dcb9b7462e">stats</a>.<a class="code" href="structargo__statistics__struct_a086695d32bb71c86470469472caf4815.html#a086695d32bb71c86470469472caf4815">ssd_time_mutex</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="swdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e.html#a5a165c3e2fa2511a6beea1dcb9b7462e">stats</a>.<a class="code" href="structargo__statistics__struct_a53d51e4d02bd4542667e5f9c984a1ec6.html#a53d51e4d02bd4542667e5f9c984a1ec6">ssd_time</a> += t2-t1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}  <span class="comment">// namespace backend</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}  <span class="comment">// namespace argo</span></div>
<div class="ttc" id="abackend_8hpp_a0fb29a8253f0d9aefc999d93414b1758_html_a0fb29a8253f0d9aefc999d93414b1758"><div class="ttname"><a href="backend_8hpp_a0fb29a8253f0d9aefc999d93414b1758.html#a0fb29a8253f0d9aefc999d93414b1758">argo::backend::_selective_acquire</a></div><div class="ttdeci">void _selective_acquire(void *addr, std::size_t size)</div><div class="ttdoc">backend internal type erased function for selective acquire</div><div class="ttdef"><b>Definition:</b> <a href="coherence_8cpp_source.html#l00017">coherence.cpp:17</a></div></div>
<div class="ttc" id="abackend_8hpp_ac3350bde3c8baf64753e515336fad3be_html_ac3350bde3c8baf64753e515336fad3be"><div class="ttname"><a href="backend_8hpp_ac3350bde3c8baf64753e515336fad3be.html#ac3350bde3c8baf64753e515336fad3be">argo::backend::_selective_release</a></div><div class="ttdeci">void _selective_release(void *addr, std::size_t size)</div><div class="ttdoc">backend internal type erased function for selective release</div><div class="ttdef"><b>Definition:</b> <a href="coherence_8cpp_source.html#l00092">coherence.cpp:92</a></div></div>
<div class="ttc" id="abackend_8hpp_html"><div class="ttname"><a href="backend_8hpp.html">backend.hpp</a></div><div class="ttdoc">This file provides the backend interface.</div></div>
<div class="ttc" id="aclassmpi__lock_a38cb3649cba54a2818810c444a8b475a_html_a38cb3649cba54a2818810c444a8b475a"><div class="ttname"><a href="classmpi__lock_a38cb3649cba54a2818810c444a8b475a.html#a38cb3649cba54a2818810c444a8b475a">mpi_lock::unlock</a></div><div class="ttdeci">void unlock(int target, MPI_Win window)</div><div class="ttdoc">release mpi_lock</div><div class="ttdef"><b>Definition:</b> <a href="mpi__lock_8cpp_source.html#l00040">mpi_lock.cpp:40</a></div></div>
<div class="ttc" id="aclassmpi__lock_a67301b26c3bb28c746e164c9f531d21d_html_a67301b26c3bb28c746e164c9f531d21d"><div class="ttname"><a href="classmpi__lock_a67301b26c3bb28c746e164c9f531d21d.html#a67301b26c3bb28c746e164c9f531d21d">mpi_lock::lock</a></div><div class="ttdeci">void lock(int lock_type, int target, MPI_Win window)</div><div class="ttdoc">acquire mpi_lock</div><div class="ttdef"><b>Definition:</b> <a href="mpi__lock_8cpp_source.html#l00014">mpi_lock.cpp:14</a></div></div>
<div class="ttc" id="anamespaceargo_1_1data__distribution_a88ff6bbc68aad43df4ae1cb78f6368bd_html_a88ff6bbc68aad43df4ae1cb78f6368bd"><div class="ttname"><a href="namespaceargo_1_1data__distribution_a88ff6bbc68aad43df4ae1cb78f6368bd.html#a88ff6bbc68aad43df4ae1cb78f6368bd">argo::data_distribution::invalid_node_id</a></div><div class="ttdeci">constexpr argo::node_id_t invalid_node_id</div><div class="ttdoc">This constant is used to represent an invalid node id.</div><div class="ttdef"><b>Definition:</b> <a href="base__distribution_8hpp_source.html#l00021">base_distribution.hpp:21</a></div></div>
<div class="ttc" id="anamespaceargo_a188a4648d6e7549bcef4cee36dcb5336_html_a188a4648d6e7549bcef4cee36dcb5336"><div class="ttname"><a href="namespaceargo_a188a4648d6e7549bcef4cee36dcb5336.html#a188a4648d6e7549bcef4cee36dcb5336">argo::node_id</a></div><div class="ttdeci">argo::node_id_t node_id()</div><div class="ttdoc">A unique ArgoDSM node identifier. Counting starts from 0.</div><div class="ttdef"><b>Definition:</b> <a href="argo_8cpp_source.html#l00109">argo.cpp:109</a></div></div>
<div class="ttc" id="anamespaceargo_ace770d0e23081b9b47668b33d4e75355_html_ace770d0e23081b9b47668b33d4e75355"><div class="ttname"><a href="namespaceargo_ace770d0e23081b9b47668b33d4e75355.html#ace770d0e23081b9b47668b33d4e75355">argo::node_id_t</a></div><div class="ttdeci">unsigned int node_id_t</div><div class="ttdoc">ArgoDSM node identifier type.</div><div class="ttdef"><b>Definition:</b> <a href="types_8hpp_source.html#l00012">types.hpp:12</a></div></div>
<div class="ttc" id="anamespaceargo_html"><div class="ttname"><a href="namespaceargo.html">argo</a></div><div class="ttdoc">ArgoDSM namespace.</div><div class="ttdef"><b>Definition:</b> <a href="allocators_8hpp_source.html#l00013">allocators.hpp:13</a></div></div>
<div class="ttc" id="astructargo__statistics__struct_a086695d32bb71c86470469472caf4815_html_a086695d32bb71c86470469472caf4815"><div class="ttname"><a href="structargo__statistics__struct_a086695d32bb71c86470469472caf4815.html#a086695d32bb71c86470469472caf4815">argo_statistics_struct::ssd_time_mutex</a></div><div class="ttdeci">std::mutex ssd_time_mutex</div><div class="ttdoc">Mutex to update ssd_time.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00117">swdsm.h:117</a></div></div>
<div class="ttc" id="astructargo__statistics__struct_a23ea11937749a7322ce532a5cf0cce4d_html_a23ea11937749a7322ce532a5cf0cce4d"><div class="ttname"><a href="structargo__statistics__struct_a23ea11937749a7322ce532a5cf0cce4d.html#a23ea11937749a7322ce532a5cf0cce4d">argo_statistics_struct::ssi_time</a></div><div class="ttdeci">double ssi_time</div><div class="ttdoc">Time spent performing selective acquire.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00111">swdsm.h:111</a></div></div>
<div class="ttc" id="astructargo__statistics__struct_a53d51e4d02bd4542667e5f9c984a1ec6_html_a53d51e4d02bd4542667e5f9c984a1ec6"><div class="ttname"><a href="structargo__statistics__struct_a53d51e4d02bd4542667e5f9c984a1ec6.html#a53d51e4d02bd4542667e5f9c984a1ec6">argo_statistics_struct::ssd_time</a></div><div class="ttdeci">double ssd_time</div><div class="ttdoc">Time spent performing selective release.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00115">swdsm.h:115</a></div></div>
<div class="ttc" id="astructargo__statistics__struct_ade3cc629c5e69fd468d589795f08db6a_html_ade3cc629c5e69fd468d589795f08db6a"><div class="ttname"><a href="structargo__statistics__struct_ade3cc629c5e69fd468d589795f08db6a.html#ade3cc629c5e69fd468d589795f08db6a">argo_statistics_struct::ssi_time_mutex</a></div><div class="ttdeci">std::mutex ssi_time_mutex</div><div class="ttdoc">Mutex to update ssi_time.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00113">swdsm.h:113</a></div></div>
<div class="ttc" id="astructmyControlData_a6db6cf5782f7ca2f19dd4e6f6d0b9e43_html_a6db6cf5782f7ca2f19dd4e6f6d0b9e43"><div class="ttname"><a href="structmyControlData_a6db6cf5782f7ca2f19dd4e6f6d0b9e43.html#a6db6cf5782f7ca2f19dd4e6f6d0b9e43">myControlData::dirty</a></div><div class="ttdeci">argo_byte dirty</div><div class="ttdoc">Tracks if page is dirty or clean.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00075">swdsm.h:75</a></div></div>
<div class="ttc" id="astructmyControlData_a74aa16e0dfe9276eb5f598545271dcf1_html_a74aa16e0dfe9276eb5f598545271dcf1"><div class="ttname"><a href="structmyControlData_a74aa16e0dfe9276eb5f598545271dcf1.html#a74aa16e0dfe9276eb5f598545271dcf1">myControlData::state</a></div><div class="ttdeci">argo_byte state</div><div class="ttdoc">Coherence state, basically only Valid/Invalid now.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00073">swdsm.h:73</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a3b6a6b2b244edb9faa79814ce8e5e9f5_html_a3b6a6b2b244edb9faa79814ce8e5e9f5"><div class="ttname"><a href="swdsm_8cpp_a3b6a6b2b244edb9faa79814ce8e5e9f5.html#a3b6a6b2b244edb9faa79814ce8e5e9f5">storepageDIFF</a></div><div class="ttdeci">void storepageDIFF(std::size_t index, std::uintptr_t addr)</div><div class="ttdoc">stores a page remotely - only writing back what has been written locally since last synchronization p...</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l01183">swdsm.cpp:1183</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9_html_a47bd1cf6b67fdc3919a12b2c622b0ae9"><div class="ttname"><a href="swdsm_8cpp_a47bd1cf6b67fdc3919a12b2c622b0ae9.html#a47bd1cf6b67fdc3919a12b2c622b0ae9">cacheControl</a></div><div class="ttdeci">control_data * cacheControl</div><div class="ttdoc">Keeps state, tag and dirty bit of the cache.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00038">swdsm.cpp:38</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a59e4c59c2940cc3727debeeff4af1889_html_a59e4c59c2940cc3727debeeff4af1889"><div class="ttname"><a href="swdsm_8cpp_a59e4c59c2940cc3727debeeff4af1889.html#a59e4c59c2940cc3727debeeff4af1889">getCacheIndex</a></div><div class="ttdeci">std::size_t getCacheIndex(std::uintptr_t addr)</div><div class="ttdoc">Gets cacheindex for a given address.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00130">swdsm.cpp:130</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e_html_a5a165c3e2fa2511a6beea1dcb9b7462e"><div class="ttname"><a href="swdsm_8cpp_a5a165c3e2fa2511a6beea1dcb9b7462e.html#a5a165c3e2fa2511a6beea1dcb9b7462e">stats</a></div><div class="ttdeci">argo_statistics stats</div><div class="ttdoc">Statistics.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00100">swdsm.cpp:100</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a5be7d91057d2e1e8933a8c92dcbd19ce_html_a5be7d91057d2e1e8933a8c92dcbd19ce"><div class="ttname"><a href="swdsm_8cpp_a5be7d91057d2e1e8933a8c92dcbd19ce.html#a5be7d91057d2e1e8933a8c92dcbd19ce">mpi_lock_sharer</a></div><div class="ttdeci">mpi_lock ** mpi_lock_sharer</div><div class="ttdoc">Mutex to protect concurrent access to same window from within node.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00071">swdsm.cpp:71</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a78647f412cdb8035c499e3ba7815fdfe_html_a78647f412cdb8035c499e3ba7815fdfe"><div class="ttname"><a href="swdsm_8cpp_a78647f412cdb8035c499e3ba7815fdfe.html#a78647f412cdb8035c499e3ba7815fdfe">sharer_windows</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; MPI_Win &gt; &gt; sharer_windows</div><div class="ttdoc">MPI window for communicating pyxis directory.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00064">swdsm.cpp:64</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a7d0d0386804df222465aaa199aab92da_html_a7d0d0386804df222465aaa199aab92da"><div class="ttname"><a href="swdsm_8cpp_a7d0d0386804df222465aaa199aab92da.html#a7d0d0386804df222465aaa199aab92da">get_sharer_win_index</a></div><div class="ttdeci">std::size_t get_sharer_win_index(int classification_index)</div><div class="ttdoc">Gets the sharer window index based on the classification index.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l01478">swdsm.cpp:1478</a></div></div>
<div class="ttc" id="aswdsm_8cpp_a8c349e3402bea4a398112f54fcfb7a0a_html_a8c349e3402bea4a398112f54fcfb7a0a"><div class="ttname"><a href="swdsm_8cpp_a8c349e3402bea4a398112f54fcfb7a0a.html#a8c349e3402bea4a398112f54fcfb7a0a">globalSharers</a></div><div class="ttdeci">std::uint64_t * globalSharers</div><div class="ttdoc">keeps track of readers and writers</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00040">swdsm.cpp:40</a></div></div>
<div class="ttc" id="aswdsm_8cpp_aa2b2930f8400209562515c100a4ed0da_html_aa2b2930f8400209562515c100a4ed0da"><div class="ttname"><a href="swdsm_8cpp_aa2b2930f8400209562515c100a4ed0da.html#aa2b2930f8400209562515c100a4ed0da">argo_write_buffer</a></div><div class="ttdeci">write_buffer&lt; std::size_t &gt; * argo_write_buffer</div><div class="ttdoc">A write buffer storing cache indices.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00056">swdsm.cpp:56</a></div></div>
<div class="ttc" id="aswdsm_8cpp_aae35b8e60baeba2eb90d7e7a83043346_html_aae35b8e60baeba2eb90d7e7a83043346"><div class="ttname"><a href="swdsm_8cpp_aae35b8e60baeba2eb90d7e7a83043346.html#aae35b8e60baeba2eb90d7e7a83043346">sync_lock</a></div><div class="ttdeci">std::shared_mutex sync_lock</div><div class="ttdoc">Mutex ensuring that only one thread can perform node-wide synchronization.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00052">swdsm.cpp:52</a></div></div>
<div class="ttc" id="aswdsm_8cpp_ac2a76a52d43c19cf7d5ed770e14c4409_html_ac2a76a52d43c19cf7d5ed770e14c4409"><div class="ttname"><a href="swdsm_8cpp_ac2a76a52d43c19cf7d5ed770e14c4409.html#ac2a76a52d43c19cf7d5ed770e14c4409">peek_homenode</a></div><div class="ttdeci">argo::node_id_t peek_homenode(std::uintptr_t addr)</div><div class="ttdoc">Gives homenode for a given address.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00170">swdsm.cpp:170</a></div></div>
<div class="ttc" id="aswdsm_8cpp_ac87b1e995ffe192a9cdd46c1686686c0_html_ac87b1e995ffe192a9cdd46c1686686c0"><div class="ttname"><a href="swdsm_8cpp_ac87b1e995ffe192a9cdd46c1686686c0.html#ac87b1e995ffe192a9cdd46c1686686c0">touchedcache</a></div><div class="ttdeci">argo_byte * touchedcache</div><div class="ttdoc">Tracks if a page is touched this epoch.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00044">swdsm.cpp:44</a></div></div>
<div class="ttc" id="aswdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f_html_ae246927bf47d0461b35f0c4c111c728f"><div class="ttname"><a href="swdsm_8cpp_ae246927bf47d0461b35f0c4c111c728f.html#ae246927bf47d0461b35f0c4c111c728f">cache_locks</a></div><div class="ttdeci">std::vector&lt; cache_lock &gt; cache_locks</div><div class="ttdoc">Pointer to locks protecting the page cache.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00050">swdsm.cpp:50</a></div></div>
<div class="ttc" id="aswdsm_8cpp_ae2fb6919b62fcd672847de7754e84e98_html_ae2fb6919b62fcd672847de7754e84e98"><div class="ttname"><a href="swdsm_8cpp_ae2fb6919b62fcd672847de7754e84e98.html#ae2fb6919b62fcd672847de7754e84e98">argo_comm</a></div><div class="ttdeci">MPI_Comm argo_comm</div><div class="ttdoc">A communicator to isolate ArgoDSM communication.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l00060">swdsm.cpp:60</a></div></div>
<div class="ttc" id="aswdsm_8cpp_aff9ea7ba7f37206d933c8dc8004dbc7b_html_aff9ea7ba7f37206d933c8dc8004dbc7b"><div class="ttname"><a href="swdsm_8cpp_aff9ea7ba7f37206d933c8dc8004dbc7b.html#aff9ea7ba7f37206d933c8dc8004dbc7b">get_classification_index</a></div><div class="ttdeci">std::size_t get_classification_index(std::uintptr_t addr)</div><div class="ttdoc">Gives an index to the sharer/writer vector depending on the address.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8cpp_source.html#l01454">swdsm.cpp:1454</a></div></div>
<div class="ttc" id="aswdsm_8h_a07958ee0efecb1f7c4fa09ecff2dd810_html_a07958ee0efecb1f7c4fa09ecff2dd810"><div class="ttname"><a href="swdsm_8h_a07958ee0efecb1f7c4fa09ecff2dd810.html#a07958ee0efecb1f7c4fa09ecff2dd810">page_size</a></div><div class="ttdeci">constexpr std::size_t page_size</div><div class="ttdoc">The size of a hardware memory page.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00315">swdsm.h:315</a></div></div>
<div class="ttc" id="aswdsm_8h_a2315af8277ada7b9534af936c69891ce_html_a2315af8277ada7b9534af936c69891ce"><div class="ttname"><a href="swdsm_8h_a2315af8277ada7b9534af936c69891ce.html#a2315af8277ada7b9534af936c69891ce">CLEAN</a></div><div class="ttdeci">static const argo_byte CLEAN</div><div class="ttdoc">Constant for clean states.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00302">swdsm.h:302</a></div></div>
<div class="ttc" id="aswdsm_8h_a3aad0c262829e881d9cfa79db6223f05_html_a3aad0c262829e881d9cfa79db6223f05"><div class="ttname"><a href="swdsm_8h_a3aad0c262829e881d9cfa79db6223f05.html#a3aad0c262829e881d9cfa79db6223f05">INVALID</a></div><div class="ttdeci">static const argo_byte INVALID</div><div class="ttdoc">Constant for invalid states.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00298">swdsm.h:298</a></div></div>
<div class="ttc" id="aswdsm_8h_a60932aba9f294e6d63e2bcaa085d4b8d_html_a60932aba9f294e6d63e2bcaa085d4b8d"><div class="ttname"><a href="swdsm_8h_a60932aba9f294e6d63e2bcaa085d4b8d.html#a60932aba9f294e6d63e2bcaa085d4b8d">DIRTY</a></div><div class="ttdeci">static const argo_byte DIRTY</div><div class="ttdoc">Constant for dirty states.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00304">swdsm.h:304</a></div></div>
<div class="ttc" id="aswdsm_8h_aa62717a1fae2c57f94f2a9b8ae08ec49_html_aa62717a1fae2c57f94f2a9b8ae08ec49"><div class="ttname"><a href="swdsm_8h_aa62717a1fae2c57f94f2a9b8ae08ec49.html#aa62717a1fae2c57f94f2a9b8ae08ec49">CACHELINE</a></div><div class="ttdeci">#define CACHELINE</div><div class="ttdoc">Size of a ArgoDSM cacheline in number of pages.</div><div class="ttdef"><b>Definition:</b> <a href="swdsm_8h_source.html#l00048">swdsm.h:48</a></div></div>
<div class="ttc" id="aswdsm_8h_html"><div class="ttname"><a href="swdsm_8h.html">swdsm.h</a></div><div class="ttdoc">this is a legacy file from the ArgoDSM prototype</div></div>
<div class="ttc" id="atests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137_html_aa66b7725a5567b78a94e77bd286ca137"><div class="ttname"><a href="tests_2allocators_8cpp_aa66b7725a5567b78a94e77bd286ca137.html#aa66b7725a5567b78a94e77bd286ca137">size</a></div><div class="ttdeci">constexpr std::size_t size</div><div class="ttdoc">ArgoDSM memory size.</div><div class="ttdef"><b>Definition:</b> <a href="tests_2allocators_8cpp_source.html#l00023">allocators.cpp:23</a></div></div>
<div class="ttc" id="avirtual__memory_8hpp_html"><div class="ttname"><a href="virtual__memory_8hpp.html">virtual_memory.hpp</a></div><div class="ttdoc">This file provides facilities for handling virtual memory and virtual address space.</div></div>
<div class="ttc" id="awrite__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973_html_ab69ecf4d8b73d23210b6ca64bca23973"><div class="ttname"><a href="write__buffer_8hpp_ab69ecf4d8b73d23210b6ca64bca23973.html#ab69ecf4d8b73d23210b6ca64bca23973">block_size</a></div><div class="ttdeci">const std::size_t block_size</div><div class="ttdoc">Block size based on backend definition.</div><div class="ttdef"><b>Definition:</b> <a href="write__buffer_8hpp_source.html#l00028">write_buffer.hpp:28</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 7 2022 15:56:58 for ArgoDSM - Software Distributed Shared Memory by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
